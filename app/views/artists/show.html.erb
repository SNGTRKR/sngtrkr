<% content_for :og_name, @artist.name
content_for :og_url, request.url
content_for :og_image, File.join(root_url , @artist.image.url(:profile))
content_for :og_description, @artist.name + " is telling fans about their new releases on SNGTRKR. Why don't you follow them too?"
content_for :og_id, @artist.id.to_s
%>
<% content_for :description do %><%= truncate((strip_tags @artist.bio || "" ), :length => 150) %><% end %>
<% content_for :title do %><%= @artist.name %> information and releases 2012<% end %>
<div class="row">
<div class="span8 offset2">
<% if can? :manage, :all %>
  <div class="super-admin">
  <%= form_for @artist do |f| %>
  <div class="ignore">
    <% if !@artist.ignore? %>
      <%= f.hidden_field :ignore, :value => true %>
      <%= f.submit "Ignore Arist", :type => :image, :src => "/images/ignore.png", :class => "i-artist" %>
    <% else %>
      <%= f.hidden_field :ignore, :value => false %>
      <%= f.submit "Unignore Arist", :type => :image, :src => "/images/unignore.png", :class => "ui-artist" %>
  
    <% end %>
    </div>
  <% end %>
  <div class="edit">
  <%= link_to edit_artist_path(@artist) do %><i class="icon-edit"></i><% end %>
  </div>
  </div>
<% end %>
<div class="row">
<div class="span4">
<div id="profile-image" style="background-image:url(<%= @artist.image.url :profile %>);background-repeat:no-repeat;background-position:center;">
<div id="opac-50"></div>
<div id="share-profile">
<h3>Share this artist</h3>
<ul>
<a href="#" title="Share on Facebook" onClick="MyWindow=window.open('https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.sngtrkr.com<%= url_for @artist %>%2F&t=SNGTRKR','ShareSNGTRKRonFacebook','scrollbars=no,width=620,height=340'); return false;"><li class="fb-icon fb-button"><i class="icon-facebook"></i></li></a>
<a href="#" title="Share on Twitter" onClick="MyWindow=window.open('https://twitter.com/intent/tweet?original_referer=http%3A%2F%2Fwww.sngtrkr.com&text=<%= @artist.name %>+is+using+SNGTRKR+to+keep+their+fans+up+to+date+with+releases.+Check+them+out+&#45;+www.sngtrkr.com<%= url_for @artist %>&via=SNGTRKR','ShareSNGTRKRonTwitter','scrollbars=no,width=620,height=340'); return false;"><li class="twit-icon twitter-button"><i class="icon-twitter"></i></li></a>
<a href="#" title="Share on Google Plus" onClick="MyWindow=window.open('https://plus.google.com/share?url=http%3A%2F%2Fwww.sngtrkr.com<%= url_for @artist %>','ShareSNGTRKRonGooglePlus','scrollbars=no,width=620,height=340'); return false;"><li class="goo-icon google-button"><i class="icon-google-plus"></i></li></a>
<div class="clear"></div>
</ul>
<div class="share-cancel">Cancel</div>
</div> <!-- share-profile -->
<div id="buy-profile">
<h3>Browse this artist</h3>
<ul>
  <li><%= link_to image_tag("/images/itunes.png", :alt => "iTunes", :title => "iTunes"), @artist.itunes, :target => "_blank" %></li>
  <li><%= link_to image_tag("/images/7digital.png", :alt => "7Digital", :title => "7Digital"), @artist.sd, :target => "_blank" %></li>
  <div class="clear"></div>
</ul>
<div class="clear"></div>
<div class="buy-cancel">Cancel</div>
</div>
<div id="social-bar-shadow"></div>
<div id="social-hidden">
<ul>
<li><a href="http://www.facebook.com/<%= @artist.fbid %>" target="_blank"><div class="fb-button fb-icon"><i class="icon-facebook"></i></div></a></li>
<% if @artist.twitter? %>
<li><a href="http://www.twitter.com/<%= @artist.twitter %>" target="_blank"><div class="twitter-button twit-icon"><i class="icon-twitter"></i></div></a></li><% else %><% end %>
<% if @artist.soundcloud? %>
<li><a href="http://www.soundcloud.com/<%= @artist.soundcloud %>" target="_blank"><div class="sc-icon soundcloud-button"><%= image_tag "/images/soundcloud.png", :alt => "Soundcloud" %></div></a></li><% else %><% end %>
<% if @artist.youtube? %>
<li><a href="http://www.youtube.com/<%= @artist.youtube %>" target="_blank"><div class=" yt-icon white-button"><%= image_tag "/images/youtube.png", :alt => "Youtube" %></div></a></li><% else %><% end %>
<% if @artist.website? %>
<li><a href="http://<%= @artist.website %>" target="_blank"><div class="sm-pop web-icon black-button"><i class="icon-globe"></i></div></a></li><% else %><% end %>
</ul>
</div></div></div>

<div class="span4">
<div id="profile-info">
	<% if user_signed_in? and current_user.managing? @artist.id %>
		<%= link_to edit_artist_path(@artist) do %><i class="icon-edit"></i><% end %>
	<% end %>
	<h2><%= @artist.name %></h2>
	<span class="tooltip-parent icon" data-title="Genre" data-placement="left">
  	<i class="icon-music"></i>
	</span><% if @artist.genre? %><%= @artist.genre %><% else %><span class="gray">No genre set</span><% end %><br/>
	<span class="tooltip-parent icon" data-title="Label" data-placement="left">
  	<i class="icon-tag"></i>
	</span>	
  <% if @artist.label_name? %><%= truncate((strip_tags @artist.label_name || "" ), :length => 50) %><% else %><span class="gray">No label set</span><% end %><br/><br/>
<div id="artist-bio">
  <% if @artist.bio? %>
    <%= raw(truncate((strip_tags @artist.bio || "" ), :length => 450, :omission => "...<a href='#bio-full'>Read more</a>")) %>
  <% else %>
    <span class="gray">No biography set</span>
  <% end %>
</div>
</div>
  <ul class="menu-user">
  <li class="buy-profile"><i class="icon-shopping-cart"></i>Buy</li>
  <li class="share-profile"><i class="icon-share-alt"></i>Share</li>
  <li class="popover-parent ajax-artist-track" data-title="Add TRKR" 
	<% if !user_signed_in? %><%=raw 'data-content="You must login before you can start tracking artists."' %><% end %>
    data-content="Keep up to date with <%= @artist.name %> and their releases, by adding them to your tracking timeline." >
    <%= render :partial => 'shared/trk_artist', :object => @artist %>
  </li>
  </ul>
</div>
<div class="clear"></div>
</div>
</div></div>
</div></div>
<div class="timeline-outer a-timeline">
<%= image_tag "/images/shadow-line.png", :id => 'shadow-top' %>
<div id="timelime-trim">
<div id="timeline">
<%= image_tag "/images/timeline-left.png", :alt => "SNGTRKR", :id => "left-logo" %>
<div id="left-line"></div>
<ul class="release-list">
<%= render :partial => 'timeline/release', :collection => @timeline.order("date ASC"), :locals => { :date_format => "%b.<br>%Y ", :date_class => 'font-15', :artist_page => 'true' } %>
<div class="clear"></div>
</ul>
</div>
</div>
</div>
<div class="container">
			<div id="bio-full">
	<div id="bio">
		<h1>Biography</h1>
		<%= raw(@artist.bio) %></div>
	</div>
	<script type="text/javascript">
$(document).ready(function(){
  $('#bio a').attr('target', '_blank');
		$(".share-profile").click(function() { $('#opac-50').fadeIn("normal"); $('#share-profile').animate({right : 0}, "slow"); $('#buy-profile').animate({left : -310}, "slow");});
		$(".share-cancel").click(function() { $('#opac-50').fadeOut("normal"); $('#share-profile').animate({right : -310}, "slow"); });
		$("#share-profile ul a li").click(function() { $('#opac-50').fadeOut("normal"); $('#share-profile').animate({right : -310}, "slow"); });
	    $(".buy-profile").click(function() { $('#opac-50').fadeIn("normal"); $('#buy-profile').animate({left : 0}, "slow"); $('#share-profile').animate({right : -310}, "slow"); });
		$(".buy-cancel").click(function() { $('#opac-50').fadeOut("normal"); $('#buy-profile').animate({left : -310}, "slow"); });
		$("#buy-profile ul li").click(function() { $('#opac-50').fadeOut("normal"); $('#buy-profile').animate({left : -310}, "slow"); });
		$("#profile-image").mouseover(function(){ $('#social-hidden ul li a div').stop().animate({bottom : -47}, "normal"); }).mouseout(function(){$('#social-hidden ul li a 						div').stop().animate({bottom : -78}, "normal");});
		$(".edit").mouseover(function(){ $('.edit').stop().animate({left : 60}, "slow");}).mouseout(function(){ $('.edit').stop().animate({left : 0}, "slow"); });
		$(".ignore").mouseover(function(){ $('.ignore').stop().animate({left : 60}, "slow");}).mouseout(function(){$('.ignore').stop().animate({left : 0}, "slow");});
		$(".r-grad").mouseover(function(){
			$(this).closest(".each-release").find('.release-info').stop().animate({bottom : 33}, "slow");
			$(this).closest(".each-release").find('.release-menu').stop().animate({bottom : 0}, "slow");
		}).mouseout(function(){
			$(this).closest(".each-release").find('.release-info').stop().animate({bottom : 13}, "slow");
			$(this).closest(".each-release").find('.release-menu').stop().animate({bottom : -25}, "slow");
		});
		$(".share-release").click(function() {
			$(this).closest(".each-release").find('.release-info').animate({bottom : -100}, "slow");
			$(this).closest(".each-release").find('.release-menu').animate({bottom : -25}, "slow");
			$(this).closest(".each-release").find('.r-grad').fadeOut("normal");
			$(this).closest(".each-release").find('.opac-50').fadeIn("normal");
			$(this).closest(".each-release").find('.share-release-list').animate({right : 0}, "slow");
		});
		$(".share-cancel").click(function() {
			$(this).closest(".each-release").find('.release-info').animate({bottom : 13}, "slow");
			$(this).closest(".each-release").find('.release-menu').animate({bottom : -25}, "slow");
			$(this).closest(".each-release").find('.r-grad').fadeIn("normal");
			$(this).closest(".each-release").find('.opac-50').fadeOut("normal");
			$(this).closest(".each-release").find('.share-release-list').animate({right : -310}, "slow");
		});
		$(".release-outer .each-release .share-release-list ul a li").click(function() {
			$(this).closest(".each-release").find('.release-info').animate({bottom : 13}, "slow");
			$(this).closest(".each-release").find('.release-menu').animate({bottom : -25}, "slow");
			$(this).closest(".each-release").find('.r-grad').fadeIn("normal");
			$(this).closest(".each-release").find('.opac-50').fadeOut("normal");
			$(this).closest(".each-release").find('.share-release-list').animate({right : -310}, "slow");
		});
		$(".buy-release").click(function() {
			$(this).closest(".each-release").find('.release-info').animate({bottom : -100}, "slow");
			$(this).closest(".each-release").find('.release-menu').animate({bottom : -25}, "slow");
			$(this).closest(".each-release").find('.r-grad').fadeOut("normal");
			$(this).closest(".each-release").find('.opac-50').fadeIn("normal");
			$(this).closest(".each-release").find('.buy-release-list').animate({left : 0}, "slow");
		});
		$(".buy-cancel").click(function() {
			$(this).closest(".each-release").find('.release-info').animate({bottom : 13}, "slow");
			$(this).closest(".each-release").find('.release-menu').animate({bottom : -25}, "slow");
			$(this).closest(".each-release").find('.r-grad').fadeIn("normal");
			$(this).closest(".each-release").find('.opac-50').fadeOut("normal");
			$(this).closest(".each-release").find('.buy-release-list').animate({left : -310}, "slow");
		});
		$(".release-outer .each-release .buy-release-list ul li").click(function() {
			$(this).closest(".each-release").find('.release-info').animate({bottom : 13}, "slow");
			$(this).closest(".each-release").find('.release-menu').animate({bottom : -25}, "slow");
			$(this).closest(".each-release").find('.r-grad').fadeIn("normal");
			$(this).closest(".each-release").find('.opac-50').fadeOut("normal");
			$(this).closest(".each-release").find('buy-release-list').animate({left : -310}, "slow");
		});
			   $(".play-release").click(function () {
	    $(this).closest(".each-release").find('.release-info').animate({
	      bottom: -100
	    }, "slow");
	    $(this).closest(".each-release").find('.release-menu').animate({
	      bottom: -25
	    }, "slow");
	    $(this).closest(".each-release").find('.r-grad').fadeOut("normal");
	    $(this).closest(".each-release").find('.opac-50').fadeIn("normal");
	    $(this).closest(".each-release").find('.play-release-list').animate({
	      top: 0
	    }, "slow");
	   	ReleaseIdGet = document.getElementById('release-parent');
	    ReleaseId = ReleaseIdGet.getAttribute('data-release-id'); 
	    alert(ReleaseId);
	    	  $.get('/artists/<%= @artist.id %>/releases//previews.json').complete(function(data){
		      console.log(data);
		      });
		     
	  });
	  $(".play-release-list .icon-remove").click(function () {
	    $(this).closest(".each-release").find('.release-info').animate({
	      bottom: 13
	    }, "slow");
	    $(this).closest(".each-release").find('.release-menu').animate({
	      bottom: -25
	    }, "slow");
	    $(this).closest(".each-release").find('.r-grad').fadeIn("normal");
	    $(this).closest(".each-release").find('.opac-50').fadeOut("normal");
	    $(this).closest(".each-release").find('.play-release-list').animate({
	      top : -310
	    }, "slow");
	  });
	  $(".release-outer .each-release .play-release-list ul a li").click(function () {
	    $(this).closest(".each-release").find('.release-info').animate({
	      bottom: 13
	    }, "slow");
	    $(this).closest(".each-release").find('.release-menu').animate({
	      bottom: -25
	    }, "slow");
	    $(this).closest(".each-release").find('.r-grad').fadeIn("normal");
	    $(this).closest(".each-release").find('.opac-50').fadeOut("normal");
	    $(this).closest(".each-release").find('.play-release-list').animate({
	      top: -310
	    }, "slow");
	  });

});
</script>
<script type="text/javascript">
//= require jquery.scrollto-1.4.2-min
var page, old_width, new_width
$(document).ready(function () {
  // Scroll to end of timeline
  // Set global AJAX load variable
  var last_load = new Date().getTime();;
  $('.release-list').width(timeline_widths());
  $("#timeline").scrollTo('max');
  page = 2
  // Ajax scroll load
  $('#timeline').scroll(function () {
    if ($(this).scrollLeft() < 500 && (new Date().getTime() - last_load) > 1000) {
      last_load = new Date().getTime();;
      $(this).trigger('mouseup');
      $.get('/users/me/timeline/' + page);
      page++;
    }
  });
  timeline_setup();


});

function timeline_widths() {
  // Width setting
  var stepsWidth = 0;
  $('.release-list .release-outer').each(function (i) {
    var $step = $(this);
    stepsWidth += $step.width() - 75;
  });
  return stepsWidth + 50
}
		</script>

		<%= render 'shared/fb_async' %>